<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>尚景云校</title>
    <meta name="viewport" content="initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <link rel="stylesheet" href="http://g.alicdn.com/msui/sm/0.6.2/css/sm.min.css">
    <link rel="stylesheet" href="http://g.alicdn.com/msui/sm/0.6.2/css/sm-extend.min.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/sjyx.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/hm_sjyx.css">
  </head>
  <body>
    <div class="page-group" >
        <div class="page">
            <!-- 标题栏 -->
            <header class="bar bar-nav">
                <a class="button button-link button-nav pull-left icon-back back" href="#"></a>
                <a id="j-select" class="button ch-select-time" href="javascript:;"><time id="j-time">今日</time><i class="arrow-bottom"></i></a>
                <h1 class="title">平安校园</h1>
            </header>

            <div class="content " >
                <div class="buttons-tab book-tab">
                    <a href="#tab1" class="tab-link active button">到校签到</a>
                    <a href="#tab2" class="tab-link button">到家签到</a>
                </div>
                <div>
                    <div class="tabs">
                        <div id="tab1" class="tab active">  
                            <div class="ch-tab-sm">
                                <div class="ch-tab-item"><a class="active" href="#">未签到(<span>2</span>)</a></div>
                                <div class="ch-tab-item"><a href="#">实际签到(<span>12</span>)</a></div>
                                <div class="ch-tab-item"><a href="#">应签到(<span>14</span>)</a></div>
                            </div>
                            <ul class="search-content tab-content ch-tab-content">
                                <li class="clearfix">
                                    <div class="pull-left">
                                        <img src="../assets/images/content-4.jpg">
                                    </div>
                                    <div class="ch-tab-right">
                                        <h2><b>张蓓蓓</b><b class="ch-no">(8524)</b> <b class="ch-sign ch-sign-yellow
                                        ">到校</b></h2>
                                        <p>15689897575 <time class="pull-right">18:00  2017.12.10</time></p>
                                    </div>
                                </li> 
                                <li class="clearfix">
                                    <div class="pull-left">
                                        <img src="../assets/images/content-4.jpg">
                                    </div>
                                    <div class="ch-tab-right">
                                        <h2><b>张蓓蓓</b><b class="ch-no">(8524)</b> <b class="ch-sign ch-sign-purple
                                        ">未签到</b></h2>
                                        <p>15689897575</p>
                                    </div>
                                </li> 
                                <li class="clearfix">
                                    <div class="pull-left">
                                        <img src="../assets/images/content-4.jpg">
                                    </div>
                                    <div class="ch-tab-right">
                                        <h2><b>张蓓蓓</b><b class="ch-no">(8524)</b> <b class="ch-sign ch-sign-red
                                        ">请假</b></h2>
                                        <p>15689897575</p>
                                    </div>
                                </li> 
                                <li class="clearfix">
                                    <div class="pull-left">
                                        <img src="../assets/images/content-4.jpg">
                                    </div>
                                    <div class="ch-tab-right">
                                        <h2><b>张蓓蓓</b><b class="ch-no">(8524)</b> <b class="ch-sign ch-sign-blue
                                        ">离校</b><b class="ch-sign ch-sign-yellow
                                        ">到校</b></h2>
                                        <p>15689897575</p>
                                    </div>
                                </li> 
                            </ul>
                            <ul class="search-content tab-content ch-tab-content">
                                <li class="clearfix">
                                    <div class="pull-left">
                                        <img src="../assets/images/content-4.jpg">
                                    </div>
                                    <div class="ch-tab-right">
                                        <h2><b>张蓓蓓2</b><b class="ch-no">(8524)</b> <b class="ch-sign ch-sign-yellow
                                        ">到校</b></h2>
                                        <p>15689897575 <time class="pull-right">18:00  2017.12.10</time></p>
                                    </div>
                                </li> 
                                <li class="clearfix">
                                    <div class="pull-left">
                                        <img src="../assets/images/content-4.jpg">
                                    </div>
                                    <div class="ch-tab-right">
                                        <h2><b>张蓓蓓</b><b class="ch-no">(8524)</b> <b class="ch-sign ch-sign-purple
                                        ">未签到</b></h2>
                                        <p>15689897575</p>
                                    </div>
                                </li> 
                                <li class="clearfix">
                                    <div class="pull-left">
                                        <img src="../assets/images/content-4.jpg">
                                    </div>
                                    <div class="ch-tab-right">
                                        <h2><b>张蓓蓓</b><b class="ch-no">(8524)</b> <b class="ch-sign ch-sign-red
                                        ">请假</b></h2>
                                        <p>15689897575</p>
                                    </div>
                                </li> 
                                <li class="clearfix">
                                    <div class="pull-left">
                                        <img src="../assets/images/content-4.jpg">
                                    </div>
                                    <div class="ch-tab-right">
                                        <h2><b>张蓓蓓</b><b class="ch-no">(8524)</b> <b class="ch-sign ch-sign-blue
                                        ">离校</b><b class="ch-sign ch-sign-yellow
                                        ">到校</b></h2>
                                        <p>15689897575</p>
                                    </div>
                                </li> 
                            </ul> 
                            <ul class="search-content tab-content ch-tab-content">
                                <li class="clearfix">
                                    <div class="pull-left">
                                        <img src="../assets/images/content-4.jpg">
                                    </div>
                                    <div class="ch-tab-right">
                                        <h2><b>张蓓蓓3</b><b class="ch-no">(8524)</b> <b class="ch-sign ch-sign-yellow
                                        ">到校</b></h2>
                                        <p>15689897575 <time class="pull-right">18:00  2017.12.10</time></p>
                                    </div>
                                </li> 
                                <li class="clearfix">
                                    <div class="pull-left">
                                        <img src="../assets/images/content-4.jpg">
                                    </div>
                                    <div class="ch-tab-right">
                                        <h2><b>张蓓蓓</b><b class="ch-no">(8524)</b> <b class="ch-sign ch-sign-purple
                                        ">未签到</b></h2>
                                        <p>15689897575</p>
                                    </div>
                                </li> 
                                <li class="clearfix">
                                    <div class="pull-left">
                                        <img src="../assets/images/content-4.jpg">
                                    </div>
                                    <div class="ch-tab-right">
                                        <h2><b>张蓓蓓</b><b class="ch-no">(8524)</b> <b class="ch-sign ch-sign-red
                                        ">请假</b></h2>
                                        <p>15689897575</p>
                                    </div>
                                </li> 
                                <li class="clearfix">
                                    <div class="pull-left">
                                        <img src="../assets/images/content-4.jpg">
                                    </div>
                                    <div class="ch-tab-right">
                                        <h2><b>张蓓蓓</b><b class="ch-no">(8524)</b> <b class="ch-sign ch-sign-blue
                                        ">离校</b><b class="ch-sign ch-sign-yellow
                                        ">到校</b></h2>
                                        <p>15689897575</p>
                                    </div>
                                </li> 
                            </ul>        
                        </div>
                        <div id="tab2" class="tab">
                            <div class="ch-tab-sm">
                                <div class="ch-tab-item"><a class="active" href="#">未签到(<span>2</span>)</a></div>
                                <div class="ch-tab-item"><a href="#">实际签到(<span>12</span>)</a></div>
                                <div class="ch-tab-item"><a href="#">应签到(<span>14</span>)</a></div>
                            </div> 
                            <ul class="search-content tab-content ch-tab-content">
                                <li class="clearfix">
                                    <div class="pull-left">
                                        <img src="../assets/images/content-4.jpg">
                                    </div>
                                    <div class="ch-tab-right">
                                        <h2><b>张蓓蓓</b> <b class="ch-no">(8524)</b> <b class="ch-sign ch-sign-green
                                        ">到校</b></h2>
                                        <p>15689897575 <time class="pull-right">18:00  2017.12.10</time></p>
                                    </div>
                                    <div class="item-reason"><i class="icon-addr"></i>高新区新东方花园西区</div>
                                </li> 
                                <li class="clearfix">
                                    <div class="pull-left">
                                        <img src="../assets/images/content-4.jpg">
                                    </div>
                                    <div class="ch-tab-right">
                                        <h2><b>张蓓蓓</b><b class="ch-no">(8524)</b> <b class="ch-sign ch-sign-purple
                                        ">未签到</b></h2>
                                        <p>15689897575</p>
                                    </div>
                                </li> 
                                <li class="clearfix">
                                    <div class="pull-left">
                                        <img src="../assets/images/content-4.jpg">
                                    </div>
                                    <div class="ch-tab-right">
                                        <h2><b>张蓓蓓</b><b class="ch-no">(8524)</b><b class="ch-sign ch-sign-red
                                        ">请假</b></h2>
                                        <p>15689897575</p>
                                    </div>
                                </li> 
                                <li class="clearfix">
                                    <div class="pull-left">
                                        <img src="../assets/images/content-4.jpg">
                                    </div>
                                    <div class="ch-tab-right">
                                        <h2><b>张蓓蓓</b><b class="ch-no">(8524)</b> <b class="ch-state ch-blue pull-right
                                        ">晚归</b></h2>
                                        <p>15689897575 <time class="pull-right">18:00  2017.12.10</time></p>
                                    </div>
                                    <div class="item-reason"><i class="icon-addr"></i>高新区新东方花园西区</div>
                                </li> 
                            </ul>  
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script type='text/javascript' src='http://g.alicdn.com/sj/lib/zepto/zepto.min.js' charset='utf-8'></script>
    <script type='text/javascript' src='http://g.alicdn.com/msui/sm/0.6.2/js/sm.min.js' charset='utf-8'></script>
    <script type='text/javascript' src='http://g.alicdn.com/msui/sm/0.6.2/js/sm-extend.min.js' charset='utf-8'></script>
    <script type="text/javascript" src="../assets/js/picker.min.js"></script>
    <script type="text/javascript" src="../assets/js/sjyx.js"></script>
    <script type="text/javascript">
        $(function(){
            $('#j-select').on('click',function(){
                picker.show();
                $(this).find('.arrow-bottom').addClass('active');
            });

            $(document).on('click', '.confirm-hook', function(){
                $('.arrow-bottom').removeClass('active');
            });

            $('#tab1').find('.ch-tab-content').hide().eq(0).show();

            $('.ch-tab-item').on('click', function(){
                var index = $(this).index();
                $(this).find('a').addClass('active');
                $('#tab1').find('.ch-tab-content').hide().eq(index).show();
            });
        });

        //时间选择

            var nameEl = document.getElementById('j-select');
            var jtime = document.getElementById('j-time');


            var first = []; /* 年 */
            var second = []; /* 月 */
            var third = []; /* 日 */
            var time; //提交传值时使用


            var now = new Date(); // 这个算法能自动处理闰年和非闰年。2012年是闰年，所以2月有29号

            //年
            var curYear = now.getFullYear();
            for(var i = curYear; i > curYear - 5; i--){
                var year = i + '年';
                var item = {
                    text: year,
                    value: i
                }
                first.push(item);
            }

            //月
            for(var i = 1; i <= 12; i++) {
                var month = i + '月';
                var item = {
                    text: month,
                    value: i
                }
                second.push(item);
            }

            //日

            var firstDay = new Date(now.getFullYear(),0,1);
            var dateDiff = now - firstDay;
            var diffDays = Math.ceil(dateDiff/ (1000 * 60 * 60 * 24)); //当期时间距离第一天的天数

            var i = 0;
            while (i < (366 - diffDays)) {
                var day = now.getDate() + '日';
                var item = {
                    text: day,
                    value: i
                }
                third.push(item);
                now = new Date(now.getTime() + 24 * 60 * 60 * 1000); // 这个是关键！！！加上一天的毫秒数效果就是把日期往后推一天
                i++;
            }


            var checked = [0, 0, 0]; /* 已选选项 */

            var picker = new Picker({
                data: [first, second, third],
                selectedIndex: [0, 0, 0],
                title: ''
            });

            picker.on('picker.select', function (selectedVal, selectedIndex) {
              var text1 = first[selectedIndex[0]].text;
              var text2 = second[selectedIndex[1]].text;
              var text3 = third[selectedIndex[2]] ? third[selectedIndex[2]].text : '';

              // var timeData = new Date().getFullYear() + text1;
              var yearData = text1.replace(/[^0-9]+/g, ',') .split(',');
              var year = plusZero(yearData[0]);

              var monthData = text2.replace(/[^0-9]+/g, ',') .split(',');
              var month = plusZero(monthData[0]);

              var dayData = text3.replace(/[^0-9]+/g, ',') .split(',');
              var day = plusZero(dayData[0]);

              //提交时使用此格式的时间值
              time = year + '.' + month + '.' + day;
              console.log(time);
              
              function plusZero(data){
                   var t;
                   return t = data < 10? ("0" + data): data;
              }

              jtime.innerHTML = time;

            });


            // nameEl.addEventListener('click', function () {
                
            // });

    </script>
  </body>
